<app-banner
  [title]="'Newsletter'"
  [subtitle]="
    'Stay informed and inspired as the latest insights and expert updates guide your journey toward smarter financial decisions.'
  "
  [desktopImage]="'/newsletter/newsletterBanner.png'"
  [mobileImage]="'/Mobile img/news letter.webp'"
  [buttons]="[
    {
      label: 'About Us',
      class: 'btn btn-lg bg-white txtorange',
      routerLink: '/contact-us'
    }
  ]"
></app-banner>

<div class="container mt-5 py-4">
  <div class="row g-5">
    <!-- SIDEBAR -->
    <aside class="col-12 col-lg-3">
      <!-- ALL CATEGORIES -->
      <div class="card recent-posts-card mb-4" class="card recent-posts-card mb-4">
        <div class="card-body p-3">
          <div class="text-accent fw-bold text-uppercase small mb-2">All Categories</div>
          <div class="accent-underline mb-3"></div>

          <ul class="list-group list-group-flush">
            <li
              *ngFor="let c of categories"
              class="list-group-item d-flex justify-content-between align-items-center px-0 category-item"
              [ngClass]="{ 'active-category': selectedCategory === c.name }"
              (click)="onItemClick(c.name, c.count, c.name)"
            >
              <a class="cursor-pointer link-dark text-decoration-none">
                {{ c.name | titlecase }}
              </a>
              <span class="text-dark">
                <b>({{ c.count }})</b>
              </span>
            </li>
          </ul>
        </div>
      </div>

      <!-- RECENT POSTS -->
      <div class="card recent-posts-card mb-4">
        <div class="card-body p-3">
          <div class="text-accent fw-bold text-uppercase small mb-2">Recent Posts</div>
          <div class="accent-underline mb-3"></div>

          <div *ngFor="let p of miniPosts" class="d-flex gap-3 align-items-start mb-3">
            <img [src]="p.image" class="recent-thumb shadow-sm" />
            <div class="flex-grow-1">
              <div class="comment-chip text-accent d-flex align-items-center gap-1 mb-1">
                <i class="bi bi-chat-dots-fill"></i>
                <span>{{ p.replyCount }} comments</span>
              </div>
              <a class="recent-title text-decoration-none">{{ p.title }}</a>
            </div>
          </div>
        </div>
      </div>

      <!-- NEED HELP BOX -->
      <div
        style="background-image: url('newsletter/newsletterOrangeBox.png')"
        class="card need-help-card text-white border-0 position-relative overflow-hidden mb-4"
      >
        <div class="card-body p-4">
          <div class="text-uppercase fw-bold lh-1 mb-2 nh-kicker">Need Help?</div>
          <div class="nh-underline mb-2"></div>

          <div class="fw-bold nh-company mb-2">Wealthmax Financial Advisers Limited</div>

          <p class="nh-line mb-2">
            The Mille, River Suite, 3rd Floor, 1000 Great West Road, Brentford, London, TW8 9DW,
            United Kingdom
          </p>
          <!-- <p class="nh-line mb-2">London, TW8 9DW</p> -->

          <p class="nh-line mb-2"><span class="fw-semibold">Phone :</span> +442036758998</p>

          <p class="nh-line mb-3">
            <span class="fw-semibold">Email :</span>
            <a class="link-light text-decoration-underline" href="mailto:contact@wealthmax.co.uk">
              {{ mail }}
            </a>
          </p>

          <button
            routerLink="/contact-us"
            class="btn btn-light rounded-3 px-3 py-2 fw-semibold nh-btn"
          >
            Contact Us
          </button>
        </div>
      </div>
    </aside>

    <main class="col-12 col-lg-9">
      <div *ngIf="loading" class="loader-wrapper">
        <div class="spinner"></div>
      </div>

      <ng-container *ngIf="!loading">
        @if (allGridPosts.length > 0 && currentCount !== 0) {
        <router-outlet></router-outlet>
        } @else {
        <app-no-newsletter-page></app-no-newsletter-page>
        }
      </ng-container>
    </main>
  </div>
</div>
